网站移动版本开发踩坑实五

1、chrome 地址栏自动隐藏交互行为对于fixed 顶部的元素遮挡

	系统：ios8.1
	浏览器：chrome 26.0.1410.53

     描述信息：页面包含fixed顶部的tip element，当页面向下滑动的时候chrome地址栏自动隐藏，当向上滑动的时候地址栏自动出现。这种交互行为本身的好处会增大用户可视、交互区域。但是在chrome 26这个版本貌似这个浏览器UI布局使用adjustPan的方式，以至于向上滑动以后fixed的元素没有被自动向下移动（没有重绘）。

<img src="./img/chrome-autohidden-influnce-fixed-element.png" width="320px" height="480px" alt="chrome自动隐藏地址栏影响fixed元素显示"/>

<a href="https://code.google.com/p/chromium/issues/detail?id=288747">bug fixed</a>
<a href="http://stackoverflow.com/questions/11258877/fixed-element-disappears-in-chrome">解决办法在这里</a>


2、360浏览器文本框获得焦点后被软键盘遮罩的问题

     系统：android4.4
     浏览器：360浏览器6.6.7

   场景是这样的，站点上筛选按钮点击后弹出层（fixed），当输入框获取焦点以后弹出系统自带的软键盘，在android上十款浏览器挨个测试比对，发现在360浏览器弹出键盘以后获取焦点的文本框被软键盘覆盖了。截图如下
    
<img src="./img/360thumb.png" width="960px" height="480px" alt="chrome自动隐藏地址栏影响fixed元素显示"/>
    
  那么问题来了，浏览器的软键盘显示出来又哪几种情况呢？英文   中文（网上找的）

  经过简单的了解，大概分析了一下软键盘在浏览器上弹出应该包含软键盘占用主activity空间，让主activity重新布局 和 不调整窗口大小浮在上面  这两种方式（哈哈这是我yy的）,360应该是使用后者，其他的也许是使用前者。

 

   既然问题出现了，那就要想办法解决，于是经过简单的推敲，基本上可以得出（存在不占用主窗口空间的软键盘技术） 1、当input获取焦点的时候，2、软键盘会弹出，3、fixed的层需要向上移动一下，4、成功输入；5、当input blur或是键盘点击回车以后,fixed还原位置（这里要庆幸360没有默认带旋转屏幕跟随转动，不然还要麻烦一点）

 

既然分析完毕就要写代码了

 1.添加识别浏览器代码

var isSpecialBrowser = navigator.userAgent.match(/360 Aphone.*\(([\d.]+)\)$/i)//360等部分软键盘采用的是软键盘不占用主窗口空间造成，吸底的 input获取焦点的时候被遮罩
2.处理事件

	$(document)
    .on('keydown keyup', Element,function(ev) {
            if(code == 13 && isSpecialBrowser) {
                    DOM.css('bottom', -310);
                }
            }
           
        })
        .on('focus', Element,function() {
            if(isSpecialBrowser) {
               DOM.css('bottom', -110);
            }
        })
        .on('blur', Element,function() {
            if(isSpecialBrowser) {
                DOM.css('bottom', -310);
            }
        });
　　

好了，问题解决了

但是会又问题，就是主动点击键盘收起按钮时没办法获取任何keycode和对应的事件，因此这里会有问题。

